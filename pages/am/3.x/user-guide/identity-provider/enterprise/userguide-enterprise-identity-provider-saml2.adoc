= SAML 2.0
:page-sidebar: am_3_x_sidebar
:page-permalink: am/current/am_userguide_enterprise_identity_provider_saml2.html
:page-folder: am/user-guide
:page-layout: am

NOTE: SAML 2.0 connector is part of our Enterprise Edition.

== Overview

SAML 2.0 stands for Security Assertion Markup Language 2.0. It is an XML-based open-standard for transferring identity data between two parties :

- a SAML authority, named an Identity Provider (IdP)
- a SAML consumer, named a Service Provider (SP)

SAML 2.0 specifies a Web Browser SSO Profile involving an identity provider (IdP), a service provider (SP), and a principal wielding an HTTP user agent (a browser)
which it's used by Gravitee.io Access Management to create a bridge between your applications and an SAML 2.0 IdP (Microsoft ADFS for example).

NOTE: In this scenario the Gravitee.io AM SAML 2.0 identity provider acts as the Service Provider (SP) via the SP-Initiated SSO flow.

image::am/current/graviteeio-am-userguide-social-idp-saml2.png[]

== Get your SAML 2.0 identity provider (IdP) metadata

To connect your applications to a SAML 2.0 IdP, you need at least the following information :

- *SingleSignOnService* : The SAML IdP Sign In URL
- *SingleLogoutService* : The SAML IdP Sign Out URL
- *Signing certificate* : The public signing certificate (encoded in PEM) provided by the identity provider.

NOTE: Request those data from your SAML IdP administrator team and make a note of them for later use.

== Create a SAML 2.0 connector

. link:/am/current/am_userguide_authentication.html[Log in to AM Console^].
. Click *Settings > Providers*.
. Click the plus icon image:icons/plus-icon.png[role="icon"].
. Select *SAML 2.0* as your identity provider type and click *Next*.
. Give your identity provider a name.
. Configure the settings (EntityID, Sign in URL, Sign out URL, Signing certificate, ...)
. Click *Create*.

NOTE: The connector provides advanced settings like the protocol binding (HTTP-REDIRECT or HTTP-POST), NameId format, Request Signing options to connect to your SAML 2.0 IdP. Ask your technical team to select the best options.

NOTE: Copy the URL in *1. Configure the Redirect URI* to the right of the page. It's the SAML 2.0 Assertion Consumer Service URL you need to provide to the SAML 2.0 IdP to register your Access Management instance.

== Test the connection

You can test your SAML 2.0 connection using a web application created in AM.

. In AM Console, click *Applications > App > Identity Providers* and select your SAML 2.0 connector.
+
image::am/current/graviteeio-am-userguide-social-idp-list.png[]
+
. Call the Login page (the `/oauth/authorize` endpoint). If the connection is working you will see a *Sign in with* button.
+
image::am/current/graviteeio-am-userguide-social-idp-login.png[]
+
If the button is not visible, there may be a problem with the identity provider settings. Check the AM Gateway log for more information.

By clicking on the *Sign in with SAML 2.0* you will be redirected your SAML 2.0 Idp login page to authenticate your users.
If your user is already connected (SSO session), the user will be automatically redirected to your application with an OAuth 2.0 access token and Open ID Connect ID token if requested.
